{% extends "base.html" %}

{% block title %}SQL Injection Test - DarkNet Defend{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card p-4">
            <h2 class="mb-4">
                <i class="bi bi-bug-fill text-danger"></i> SQL Injection Protection Test
            </h2>
            
            <div class="alert alert-info">
                <i class="bi bi-info-circle"></i>
                <strong>Safe Testing Environment</strong><br>
                This page allows you to safely test SQL injection attacks. All attempts will be blocked and logged.
            </div>
            
            <h4 class="mb-3">Common SQL Injection Attacks</h4>
            
            <div class="row g-2 mb-4">
                <div class="col-md-6">
                    <div class="card bg-dark border-danger p-3">
                        <h6 class="text-danger">Attack 1: Authentication Bypass</h6>
                        <code class="text-warning d-block mb-2">' OR '1'='1</code>
                        <button class="btn btn-sm btn-outline-danger" onclick="testAttack(this.previousElementSibling.textContent)">
                            Test This
                        </button>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card bg-dark border-danger p-3">
                        <h6 class="text-danger">Attack 2: Drop Table</h6>
                        <code class="text-warning d-block mb-2">'; DROP TABLE users--</code>
                        <button class="btn btn-sm btn-outline-danger" onclick="testAttack(this.previousElementSibling.textContent)">
                            Test This
                        </button>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card bg-dark border-danger p-3">
                        <h6 class="text-danger">Attack 3: Union Select</h6>
                        <code class="text-warning d-block mb-2">' UNION SELECT * FROM users--</code>
                        <button class="btn btn-sm btn-outline-danger" onclick="testAttack(this.previousElementSibling.textContent)">
                            Test This
                        </button>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card bg-dark border-danger p-3">
                        <h6 class="text-danger">Attack 4: Comment Injection</h6>
                        <code class="text-warning d-block mb-2">admin'--</code>
                        <button class="btn btn-sm btn-outline-danger" onclick="testAttack(this.previousElementSibling.textContent)">
                            Test This
                        </button>
                    </div>
                </div>
            </div>
            
            <h4 class="mb-3">Test Your Own Input</h4>
            <form method="POST">
                <div class="mb-3">
                    <label for="test_input" class="form-label">Enter SQL Injection Code:</label>
                    <textarea class="form-control" id="test_input" name="test_input" 
                              rows="3" placeholder="Type or paste SQL injection code here..."
                              style="font-family: monospace;"></textarea>
                </div>
                
                <button type="submit" class="btn btn-danger btn-lg w-100">
                    <i class="bi bi-shield-x"></i> Test SQL Injection
                </button>
            </form>
            
            <div class="alert alert-success mt-4">
                <h5><i class="bi bi-shield-check"></i> Protection Status</h5>
                <ul class="mb-0">
                    <li><strong>Pattern Detection:</strong> ✅ Active</li>
                    <li><strong>Parameterized Queries:</strong> ✅ Enabled</li>
                    <li><strong>Logging:</strong> ✅ All attempts recorded</li>
                    <li><strong>Blocking:</strong> ✅ Malicious input rejected</li>
                </ul>
            </div>
            
            <div class="mt-4">
                <a href="{{ url_for('dashboard') }}" class="btn btn-outline-primary">
                    <i class="bi bi-arrow-left"></i> Back to Dashboard
                </a>
                <a href="{{ url_for('alerts') }}" class="btn btn-outline-warning">
                    <i class="bi bi-list"></i> View Security Logs
                </a>
            </div>
        </div>
    </div>
</div>

<script>
function testAttack(attackCode) {
    document.getElementById('test_input').value = attackCode;
    document.getElementById('test_input').focus();
    document.getElementById('test_input').style.borderColor = '#dc3545';
    document.getElementById('test_input').style.boxShadow = '0 0 15px rgba(220, 53, 69, 0.5)';
    
    // Scroll to form
    document.getElementById('test_input').scrollIntoView({ behavior: 'smooth', block: 'center' });
}
</script>

{% endblock %}